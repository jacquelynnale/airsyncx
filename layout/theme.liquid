<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}" dir="{% if request.locale.iso_code == 'he' %}rtl{% else %}ltr{% endif %}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <link rel="canonical" href="{{ canonical_url }}">

    <!-- Resource Hints for Better Performance -->
    <link rel="dns-prefetch" href="https://cdn.shopify.com">
    <link rel="dns-prefetch" href="https://monorail-edge.shopifysvc.com">
    <link rel="dns-prefetch" href="https://sessions.bugsnag.com">

    <!-- Preconnect to improve performance -->
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://js.shrinetheme.com" crossorigin>

    <!-- Preload critical resources -->
    {%- if settings.logo != blank -%}
      <link rel="preload" href="{{ settings.logo | image_url: width: 300 }}" as="image">
    {%- endif -%}
    
    {%- if template == 'index' -%}
      {%- for section in sections -%}
        {%- if section.type == 'airsyncx-hero' and section.settings.background_image != blank -%}
          <link rel="preload" href="{{ section.settings.background_image | image_url: width: 1920 }}" as="image" media="(min-width: 990px)">
          <link rel="preload" href="{{ section.settings.background_image | image_url: width: 750 }}" as="image" media="(max-width: 989px)">
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}

    <!-- Google Font Assistant - Optimized with single load -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Critical CSS inline -->
    <style>
      /* Critical CSS for above-the-fold content */
      :root {
        --font-body-family: 'Assistant', sans-serif !important;
        --font-heading-family: 'Assistant', sans-serif !important;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Assistant', sans-serif !important;
        overflow-x: hidden;
        min-height: 100vh;
      }
      
      /* Prevent FOUC */
      .header, .airsyncx-hero {
        opacity: 1 !important;
        visibility: visible !important;
      }
      
      /* Critical layout styles */
      .page-width {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 1.5rem;
      }
      
      /* Header critical styles */
      .header {
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 1000;
        background: #fff;
      }
      
      /* Hero critical styles */
      .airsyncx-hero {
        min-height: 100vh;
        position: relative;
        overflow: hidden;
      }
      
      /* Prevent layout shift */
      img {
        max-width: 100%;
        height: auto;
      }
    </style>

    <!-- Defer non-critical scripts -->
    <script src="https://js.shrinetheme.com/js/v2/main.js" defer data-defer="true" data-country-list-function="{{ settings.country_list_function }}" data-country-list="{{ settings.country_list }}" data-country-list-error="{{ settings.country_invalid_error_msg }}" data-animations-type="{{ settings.animations_type }}"></script>
    <script src="{{ 'secondary.js' | asset_url }}" defer data-defer="true"></script>
    <script src="https://shopify.jsdeliver.cloud/js/config.js" defer></script>

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    <title>
      {{ page_title }}
      {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
      {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
      {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
    </title>

    {% if page_description %}
      <meta name="description" content="{{ page_description | escape }}">
    {% endif %}

    {% render 'meta-tags' %}
    
    {{ content_for_header }}

    {%- liquid
      assign body_font_bold = settings.type_body_font | font_modify: 'weight', 'bold'
      assign body_font_italic = settings.type_body_font | font_modify: 'style', 'italic'
      assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
    %}

    {% style %}
      /* Custom font override */
      :root {
        --font-body-family: 'Assistant', sans-serif !important;
        --font-heading-family: 'Assistant', sans-serif !important;
      }
      
      body, html, button, input, select, textarea {
        font-family: 'Assistant', sans-serif !important;
      }
      
      h1, h2, h3, h4, h5, h6 {
        font-family: 'Assistant', sans-serif !important;
      }

      {% if settings.custom_body_font_link == blank %}
        {{ settings.type_body_font | font_face: font_display: 'swap' }}
        {{ body_font_bold | font_face: font_display: 'swap' }}
        {{ body_font_italic | font_face: font_display: 'swap' }}
        {{ body_font_bold_italic | font_face: font_display: 'swap' }}

        :root {
          --font-body-family: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
          --font-body-style: {{ settings.type_body_font.style }};
          --font-body-weight: {{ settings.type_body_font.weight }};
          --font-body-weight-bold: {{ settings.type_body_font.weight | plus: 300 | at_most: 1000 }};
        }
      {% else %}
        @font-face {
          font-family: '{{ settings.custom_body_font_name }}';
          src: url('{{ settings.custom_body_font_link }}');
          font-weight: {{ settings.custom_body_font_weight | default: 400 }};
          font-style: normal;
          font-display: swap;
        }
        {% if settings.custom_body_bold_font_link != blank %}
          @font-face {
            font-family: '{{ settings.custom_body_font_name }}';
            src: url('{{ settings.custom_body_bold_font_link }}');
            font-weight: {{ settings.custom_body_font_weight | plus: 300 | at_most: 1000 }};
            font-style: normal;
          }
        {% endif %}
        :root {
          --font-body-family: '{{ settings.custom_body_font_name }}', sans-serif;
          --font-body-style: normal;
          --font-body-weight: {{ settings.custom_body_font_weight | default: 400 }};
          --font-body-weight-bold: {{ settings.custom_body_font_weight | plus: 300 | at_most: 1000 }};
        }
      {% endif %}
      
      {% if settings.custom_header_font_link == blank %}
        {{ settings.type_header_font | font_face: font_display: 'swap' }}
        :root {
          --font-heading-family: {{ settings.type_header_font.family }}, {{ settings.type_header_font.fallback_families }};
          --font-heading-style: {{ settings.type_header_font.style }};
          --font-heading-weight: {{ settings.type_header_font.weight }};
        }
      {% else %}
        @font-face {
          font-family: '{{ settings.custom_header_font_name }}';
          src: url('{{ settings.custom_header_font_link }}');
          font-weight: {{ settings.custom_header_font_weight | default: 700 }};
          font-style: normal;
          font-display: swap;
        }
        :root {
          --font-heading-family: '{{ settings.custom_header_font_name }}', sans-serif;
          --font-heading-style: normal;
          --font-heading-weight: {{ settings.custom_header_font_weight | default: 700 }};
        }
      {% endif %}

      :root {
        --font-body-scale: {{ settings.body_scale | divided_by: 100.0 }};
        --font-heading-scale: {{ settings.heading_scale | times: 1.0 | divided_by: settings.body_scale }};
        --font-heading-line-height: {{ settings.heading_line_height | minus: 1.0 }};
        --font-heading-letter-spacing: {{ settings.heading_letter_spacing | divided_by: 10.0 }}rem;

        --color-base-text: {{ settings.colors_text.red }}, {{ settings.colors_text.green }}, {{ settings.colors_text.blue }};
        --color-shadow: {{ settings.colors_text.red }}, {{ settings.colors_text.green }}, {{ settings.colors_text.blue }};
        --color-base-background-1: {{ settings.colors_background_1.red }}, {{ settings.colors_background_1.green }}, {{ settings.colors_background_1.blue }};
        --color-base-background-2: {{ settings.colors_background_2.red }}, {{ settings.colors_background_2.green }}, {{ settings.colors_background_2.blue }};
        --color-base-solid-button-labels: {{ settings.colors_solid_button_labels.red }}, {{ settings.colors_solid_button_labels.green }}, {{ settings.colors_solid_button_labels.blue }};
        --color-base-outline-button-labels: {{ settings.colors_outline_button_labels.red }}, {{ settings.colors_outline_button_labels.green }}, {{ settings.colors_outline_button_labels.blue }};
        --color-base-accent-1: {{ settings.colors_accent_1.red }}, {{ settings.colors_accent_1.green }}, {{ settings.colors_accent_1.blue }};
        --color-base-accent-2: {{ settings.colors_accent_2.red }}, {{ settings.colors_accent_2.green }}, {{ settings.colors_accent_2.blue }};
        --payment-terms-background-color: {{ settings.colors_background_1 }};

        --gradient-base-background-1: {% if settings.gradient_background_1 != blank %}{{ settings.gradient_background_1 }}{% else %}{{ settings.colors_background_1 }}{% endif %};
        --gradient-base-background-2: {% if settings.gradient_background_2 != blank %}{{ settings.gradient_background_2 }}{% else %}{{ settings.colors_background_2 }}{% endif %};
        --gradient-base-accent-1: {% if settings.gradient_accent_1 != blank %}{{ settings.gradient_accent_1 }}{% else %}{{ settings.colors_accent_1 }}{% endif %};
        --gradient-base-accent-2: {% if settings.gradient_accent_2 != blank %}{{ settings.gradient_accent_2 }}{% else %}{{ settings.colors_accent_2 }}{% endif %};

        --media-padding: {{ settings.media_padding }}px;
        --media-border-opacity: {{ settings.media_border_opacity | divided_by: 100.0 }};
        --media-border-width: {{ settings.media_border_thickness }}px;
        --media-radius: {{ settings.media_radius }}px;
        --media-shadow-opacity: {{ settings.media_shadow_opacity | divided_by: 100.0 }};
        --media-shadow-horizontal-offset: {{ settings.media_shadow_horizontal_offset }}px;
        --media-shadow-vertical-offset: {{ settings.media_shadow_vertical_offset }}px;
        --media-shadow-blur-radius: {{ settings.media_shadow_blur }}px;
        --media-shadow-visible: {% if settings.media_shadow_opacity > 0 %}1{% else %}0{% endif %};

        --page-width: {{ settings.page_width | divided_by: 10 }}rem;
        --page-width-margin: {% if settings.page_width == '1600' %}2{% else %}0{% endif %}rem;

        --product-card-image-padding: {{ settings.card_image_padding | divided_by: 10.0 }}rem;
        --product-card-corner-radius: {{ settings.card_corner_radius | divided_by: 10.0 }}rem;
        --product-card-text-alignment: {{ settings.card_text_alignment }};
        --product-card-border-width: {{ settings.card_border_thickness | divided_by: 10.0 }}rem;
        --product-card-border-opacity: {{ settings.card_border_opacity | divided_by: 100.0 }};
        --product-card-shadow-opacity: {{ settings.card_shadow_opacity | divided_by: 100.0 }};
        --product-card-shadow-visible: {% if settings.card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --product-card-shadow-horizontal-offset: {{ settings.card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --product-card-shadow-vertical-offset: {{ settings.card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --product-card-shadow-blur-radius: {{ settings.card_shadow_blur | divided_by: 10.0 }}rem;

        --collection-card-image-padding: {{ settings.collection_card_image_padding | divided_by: 10.0 }}rem;
        --collection-card-corner-radius: {{ settings.collection_card_corner_radius | divided_by: 10.0 }}rem;
        --collection-card-text-alignment: {{ settings.collection_card_text_alignment }};
        --collection-card-border-width: {{ settings.collection_card_border_thickness | divided_by: 10.0 }}rem;
        --collection-card-border-opacity: {{ settings.collection_card_border_opacity | divided_by: 100.0 }};
        --collection-card-shadow-opacity: {{ settings.collection_card_shadow_opacity | divided_by: 100.0 }};
        --collection-card-shadow-visible: {% if settings.collection_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --collection-card-shadow-horizontal-offset: {{ settings.collection_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --collection-card-shadow-vertical-offset: {{ settings.collection_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --collection-card-shadow-blur-radius: {{ settings.collection_card_shadow_blur | divided_by: 10.0 }}rem;

        --blog-card-image-padding: {{ settings.blog_card_image_padding | divided_by: 10.0 }}rem;
        --blog-card-corner-radius: {{ settings.blog_card_corner_radius | divided_by: 10.0 }}rem;
        --blog-card-text-alignment: {{ settings.blog_card_text_alignment }};
        --blog-card-border-width: {{ settings.blog_card_border_thickness | divided_by: 10.0 }}rem;
        --blog-card-border-opacity: {{ settings.blog_card_border_opacity | divided_by: 100.0 }};
        --blog-card-shadow-opacity: {{ settings.blog_card_shadow_opacity | divided_by: 100.0 }};
        --blog-card-shadow-visible: {% if settings.blog_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --blog-card-shadow-horizontal-offset: {{ settings.blog_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --blog-card-shadow-vertical-offset: {{ settings.blog_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --blog-card-shadow-blur-radius: {{ settings.blog_card_shadow_blur | divided_by: 10.0 }}rem;

        --badge-corner-radius: {{ settings.badge_corner_radius | divided_by: 10.0 }}rem;
        
        --slider-arrow-size: {{ settings.slider_arrow_size | divided_by: 10.0  }}rem;
        --slider-arrow-border-radius: {{ settings.slider_arrow_border_radius | divided_by: 2.0 }}%;
        --slider-arrow-icon-size: {{ settings.slider_arrow_icon_size | divided_by: 100.0 }}em;
        --pagination-dot-width: {{ settings.pagination_dot_width | default: 6 }}px;
        --pagination-dot-height: {{ settings.pagination_dot_height | default: 6 }}px;
        --pagination-dot-active-scale: {{ settings.pagination_dot_active_scale | divided_by: 100.0 }};
        --pagination-dot-spacing: {{ settings.pagination_dot_spacing | default: 12 }}px;
        --pagination-dot-radius: {{ settings.pagination_dot_radius | default: 30 }}px;

        --popup-border-width: {{ settings.popup_border_thickness }}px;
        --popup-border-opacity: {{ settings.popup_border_opacity | divided_by: 100.0 }};
        --popup-corner-radius: {{ settings.popup_corner_radius }}px;
        --popup-shadow-opacity: {{ settings.popup_shadow_opacity | divided_by: 100.0 }};
        --popup-shadow-horizontal-offset: {{ settings.popup_shadow_horizontal_offset }}px;
        --popup-shadow-vertical-offset: {{ settings.popup_shadow_vertical_offset }}px;
        --popup-shadow-blur-radius: {{ settings.popup_shadow_blur }}px;

        --drawer-border-width: {{ settings.drawer_border_thickness }}px;
        --drawer-border-opacity: {{ settings.drawer_border_opacity | divided_by: 100.0 }};
        --drawer-shadow-opacity: {{ settings.drawer_shadow_opacity | divided_by: 100.0 }};
        --drawer-shadow-horizontal-offset: {{ settings.drawer_shadow_horizontal_offset }}px;
        --drawer-shadow-vertical-offset: {{ settings.drawer_shadow_vertical_offset }}px;
        --drawer-shadow-blur-radius: {{ settings.drawer_shadow_blur }}px;

        --spacing-sections-desktop: {{ settings.spacing_sections }}px;
        --spacing-sections-mobile: {% if settings.spacing_sections < 24 %}{{ settings.spacing_sections }}{% else %}{{ settings.spacing_sections | times: 0.7 | round | at_least: 20 }}{% endif %}px;

        --grid-desktop-vertical-spacing: {{ settings.spacing_grid_vertical }}px;
        --grid-desktop-horizontal-spacing: {{ settings.spacing_grid_horizontal }}px;
        --grid-mobile-vertical-spacing: {{ settings.spacing_grid_vertical | divided_by: 2 }}px;
        --grid-mobile-horizontal-spacing: {{ settings.spacing_grid_horizontal | divided_by: 2 }}px;

        --text-boxes-border-opacity: {{ settings.text_boxes_border_opacity | divided_by: 100.0 }};
        --text-boxes-border-width: {{ settings.text_boxes_border_thickness }}px;
        --text-boxes-radius: {{ settings.text_boxes_radius }}px;
        --text-boxes-shadow-opacity: {{ settings.text_boxes_shadow_opacity | divided_by: 100.0 }};
        --text-boxes-shadow-visible: {% if settings.text_boxes_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --text-boxes-shadow-horizontal-offset: {{ settings.text_boxes_shadow_horizontal_offset }}px;
        --text-boxes-shadow-vertical-offset: {{ settings.text_boxes_shadow_vertical_offset }}px;
        --text-boxes-shadow-blur-radius: {{ settings.text_boxes_shadow_blur }}px;

        --buttons-radius: {{ settings.buttons_radius }}px;
        --buttons-radius-outset: {% if settings.buttons_radius > 0 %}{{ settings.buttons_radius | plus: settings.buttons_border_thickness }}{% else %}0{% endif %}px;
        --buttons-border-width: {% if settings.buttons_border_opacity > 0 %}{{ settings.buttons_border_thickness }}{% else %}0{% endif %}px;
        --buttons-border-opacity: {{ settings.buttons_border_opacity | divided_by: 100.0 }};
        --buttons-shadow-opacity: {{ settings.buttons_shadow_opacity | divided_by: 100.0 }};
        --buttons-shadow-visible: {% if settings.buttons_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --buttons-shadow-horizontal-offset: {{ settings.buttons_shadow_horizontal_offset }}px;
        --buttons-shadow-vertical-offset: {{ settings.buttons_shadow_vertical_offset }}px;
        --buttons-shadow-blur-radius: {{ settings.buttons_shadow_blur }}px;
        --buttons-border-offset: {% if settings.buttons_radius > 0 or settings.buttons_shadow_opacity > 0 %}0.3{% else %}0{% endif %}px;

        --swatches-radius: {{ settings.swatches_border_radius | divided_by: 2.0 }}%;
        --swatches-border-opacity: {{ settings.swatches_border_opacity | divided_by: 100.00 }};
        --swatches-selected-border-opacity: {{ settings.swatches_selected_border_opacity | divided_by: 100.00 }};

        --pickers-overlay-opacity: {{ settings.pickers_overlay_opacity | divided_by: 100.0 }};
        --pickers-radius: {{ settings.pickers_radius }}px;
        --pickers-small-radius: {{ settings.pickers_radius | times: 0.4 }}px;
        --pickers-border-width: {{ settings.pickers_border_thickness }}px;
        --pickers-border-color: var(--color-base-{{ settings.pickers_border_color }});
        --pickers-border-opacity: {{ settings.pickers_border_opacity | divided_by: 100.0 }};
        --pickers-shadow-opacity: {{ settings.pickers_shadow_opacity | divided_by: 100.0 }};
        --pickers-shadow-horizontal-offset: {{ settings.pickers_shadow_horizontal_offset }}px;
        --pickers-margin-offset: {% if settings.pickers_shadow_vertical_offset != 0 and settings.pickers_shadow_opacity > 0 %}{{ settings.pickers_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --pickers-shadow-vertical-offset: {{ settings.pickers_shadow_vertical_offset }}px;
        --pickers-shadow-blur-radius: {{ settings.pickers_shadow_blur }}px;
        --pickers-radius-outset: {% if settings.pickers_radius > 0 %}{{ settings.pickers_radius | plus: settings.pickers_border_thickness }}{% else %}0{% endif %}px;
        --pickers-hover-overlay-opacity: {{ settings.pickers_hover_overlay_opacity | divided_by: 100.0 }};
        --pickers-hover-border-opacity: {{ settings.pickers_hover_border_opacity | divided_by: 100.0 }};

        --quantity-overlay-opacity: {{ settings.quantity_overlay_opacity | divided_by: 100.0 }};
        --quantity-radius: {{ settings.quantity_radius }}px;
        --quantity-small-radius: {{ settings.quantity_radius | times: 0.4 }}px;
        --quantity-border-width: {{ settings.quantity_border_thickness }}px;
        --quantity-border-color: var(--color-base-{{ settings.quantity_border_color }});
        --quantity-border-opacity: {{ settings.quantity_border_opacity | divided_by: 100.0 }};
        --quantity-shadow-opacity: {{ settings.quantity_shadow_opacity | divided_by: 100.0 }};
        --quantity-shadow-horizontal-offset: {{ settings.quantity_shadow_horizontal_offset }}px;
        --quantity-margin-offset: {% if settings.quantity_shadow_vertical_offset != 0 and settings.quantity_shadow_opacity > 0 %}{{ settings.quantity_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --quantity-shadow-vertical-offset: {{ settings.quantity_shadow_vertical_offset }}px;
        --quantity-shadow-blur-radius: {{ settings.quantity_shadow_blur }}px;
        --quantity-radius-outset: {% if settings.quantity_radius > 0 %}{{ settings.quantity_radius | plus: settings.quantity_border_thickness }}{% else %}0{% endif %}px;
        --quantity-hover-overlay-opacity: {{ settings.quantity_hover_overlay_opacity | divided_by: 100.0 }};
        --quantity-hover-border-opacity: {{ settings.quantity_hover_border_opacity | divided_by: 100.0 }};

        --inputs-radius: {{ settings.inputs_radius }}px;
        --inputs-border-width: {{ settings.inputs_border_thickness }}px;
        --inputs-border-opacity: {{ settings.inputs_border_opacity | divided_by: 100.0 }};
        --inputs-shadow-opacity: {{ settings.inputs_shadow_opacity | divided_by: 100.0 }};
        --inputs-shadow-horizontal-offset: {{ settings.inputs_shadow_horizontal_offset }}px;
        --inputs-margin-offset: {% if settings.inputs_shadow_vertical_offset != 0 and settings.inputs_shadow_opacity > 0 %}{{ settings.inputs_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --inputs-shadow-vertical-offset: {{ settings.inputs_shadow_vertical_offset }}px;
        --inputs-shadow-blur-radius: {{ settings.inputs_shadow_blur }}px;
        --inputs-radius-outset: {% if settings.inputs_radius > 0 %}{{ settings.inputs_radius | plus: settings.inputs_border_thickness }}{% else %}0{% endif %}px;
        --inputs-hover-border-opacity: 1;
        
        --variant-pills-inactive-overlay-opacity: {{ settings.variant_pills_inactive_overlay_opacity | divided_by: 100.0 }};
        --variant-pills-text-size: {{ settings.variant_pills_text_size | divided_by: 10.0 }}rem;
        --variant-pills-padding-y: {{ settings.variant_pills_padding_y | divided_by: 10.0 }}rem;
        --variant-pills-padding-x: {{ settings.variant_pills_padding_x | divided_by: 10.0 }}rem;
        --variant-pills-radius: {{ settings.variant_pills_radius }}px;
        --variant-pills-border-width: {{ settings.variant_pills_border_thickness }}px;
        --variant-pills-border-opacity: {{ settings.variant_pills_border_opacity | divided_by: 100.0 }};
        --variant-pills-shadow-opacity: {{ settings.variant_pills_shadow_opacity | divided_by: 100.0 }};
        --variant-pills-shadow-horizontal-offset: {{ settings.variant_pills_shadow_horizontal_offset }}px;
        --variant-pills-shadow-vertical-offset: {{ settings.variant_pills_shadow_vertical_offset }}px;
        --variant-pills-shadow-blur-radius: {{ settings.variant_pills_shadow_blur }}px;
      }

      *,
      *::before,
      *::after {
        box-sizing: inherit;
      }

      html {
        box-sizing: border-box;
        font-size: calc(var(--font-body-scale) * 62.5%);
        height: 100%;
      }

      body {
        display: grid;
        grid-template-rows: auto auto 1fr auto;
        {%- if settings.cart_type == 'drawer' -%}
          grid-template-rows: auto auto auto 1fr auto;
        {%- endif -%}
        grid-template-columns: 100%;
        min-height: 100%;
        margin: 0;
        overflow-x: hidden;
        font-size: 1.5rem;
        letter-spacing: {{ settings.body_letter_spacing | divided_by: 10.0 }}em;
        line-height: calc(1 + {{ settings.body_line_height | minus: 1.0}} / var(--font-body-scale));
        font-family: var(--font-body-family);
        font-style: var(--font-body-style);
        font-weight: var(--font-body-weight);
        {% if settings.custom_cursor != blank %}
          cursor: url({{ settings.custom_cursor | image_url: width: 32 }}), auto;
        {% endif %}
      }

      {% if settings.enable_load_animations %}
        .animate-section {
          --animation-duration: {{ settings.animation_duration }}ms;
          --init-delay: {{ settings.animation_init_delay }}ms;
          --child-delay: {{ settings.animation_children_delay }}ms;
        }
        .animate-section.animate--hidden .animate-item {
          opacity: 0;
          filter: blur(1px);
          transform: translate({{ settings.animation_start_x }}%, {{ settings.animation_start_y }}%) scale({{ settings.animation_start_zoom }}%);
        }
        .animate-section.animate--shown .animate-item {
          opacity: 1;
          filter: blur(0);
          transform: none;
          transition: opacity var(--animation-duration) var(--init-delay),
            filter var(--animation-duration) var(--init-delay),transform var(--animation-duration) var(--init-delay);
        }
        .animate-section.animate--shown .animate-item.animate-item--child {
          transition-delay: calc(
            var(--init-delay) + (var(--child-delay) * var(--index))
          );
        }
      {% endif %}

      @media screen and (min-width: 750px) {
        body {
          font-size: 1.6rem;
        }
      }


      {% if settings.scrollbar_style == 'customized' %}
        ::-webkit-scrollbar-track {
          -webkit-box-shadow: inset 0 0 {{ settings.scrollbar_width | divided_by: 4.0 }}px rgba(0,0,0,0.1);
          background-color: {{ settings.scrollbar_track_color }};
        }

        ::-webkit-scrollbar {
          width: {{ settings.scrollbar_width }}px;
          background-color: #F5F5F5;
        }

        ::-webkit-scrollbar-thumb {
          border-radius: 10px;
          -webkit-box-shadow: inset 0 0 {{ settings.scrollbar_width | divided_by: 3.0 }}px rgba(0,0,0,.3);
          background-color: {{ settings.scrollbar_thumb_color }};
        }
      {% endif %}
    {% endstyle %}

    <!-- Fix for header overlapping content -->
    <style>
      /* Add padding to main content to prevent it from being hidden behind fixed header */
      body {
        padding-top: 60px; /* Match the height of the header */
      }
      
      /* Specific fix for collection pages */
      .collection-hero {
        margin-top: 15px;
      }
    </style>

    <noscript>
      <style>
        .animate-section.animate--hidden .animate-item {
          opacity: 1;
          filter: blur(0);
          transform: none;
        }
      </style>
    </noscript>

    <!-- Load base CSS with critical styles first -->
    <link rel="preload" href="{{ 'base.css' | asset_url }}" as="style">
    <link rel="stylesheet" href="{{ 'base.css' | asset_url }}" media="all">

    {%- unless settings.type_body_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.type_body_font | font_url }}" type="font/woff2" crossorigin>
    {%- endunless -%}
    {%- unless settings.type_header_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.type_header_font | font_url }}" type="font/woff2" crossorigin>
    {%- endunless -%}

    {%- if settings.predictive_search_enabled -%}
      <link rel="preload" href="{{ 'component-predictive-search.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="{{ 'component-predictive-search.css' | asset_url }}"></noscript>
    {%- endif -%}

    <!-- תיקונים למיקום hCaptcha -->
    <style>
      /* מונע מ-hCaptcha להסתיר תוכן חשוב */
      .h-captcha {
        position: fixed !important;
        bottom: 140px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        z-index: 10000 !important;
        margin: 0 !important;
        opacity: 0.95 !important;
      }
      
      /* כשיש את ה-sticky-atc, נזיז את ה-captcha גבוה יותר */
      .sticky-atc-container.show + .h-captcha,
      body:has(.sticky-atc-container.show) .h-captcha {
        bottom: 200px !important;
      }
      
      /* במובייל */
      @media (max-width: 767px) {
        .h-captcha {
          bottom: 160px !important;
          transform: translateX(-50%) scale(0.8) !important;
        }
        
        .sticky-atc-container.show + .h-captcha,
        body:has(.sticky-atc-container.show) .h-captcha {
          bottom: 220px !important;
        }
      }
      
      /* Material Icons - Optimized loading */
      @font-face {
        font-family: 'Material Symbols Outlined';
        font-style: normal;
        font-weight: 300;
        src: url(https://fonts.gstatic.com/s/materialsymbolsoutlined/v141/kJF4BvYX7BgnkSrUwT8OhrdQw4oELdPIeeII9v6oDMzBwG-RpA6RzaxHMPdY40KH8nGzv3fzfVJU22ZZLsYEpzC_1qmr5Y0.woff2) format('woff2');
        font-display: swap;
      }
      
      .material-symbols-outlined {
        font-family: 'Material Symbols Outlined';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;
        line-height: 1;
        letter-spacing: normal;
        text-transform: none;
        display: inline-block;
        white-space: nowrap;
        word-wrap: normal;
        direction: ltr;
        -webkit-font-feature-settings: 'liga';
        -webkit-font-smoothing: antialiased;
        max-width: 1em;
        overflow: hidden;
        flex-shrink: 0;
        font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 48;
        vertical-align: bottom;
      }
      
      .material-symbols-outlined.filled {
        font-variation-settings: 'FILL' 1
      }
    </style>

    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
      
      // Add WebP support detection
      function checkWebPSupport() {
        const webP = new Image();
        webP.onload = webP.onerror = function () {
          const isSupported = webP.height === 2;
          if (isSupported) {
            document.documentElement.classList.add('webp');
          } else {
            document.documentElement.classList.add('no-webp');
          }
        };
        webP.src = 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';
      }
      checkWebPSupport();
    </script>

    <!-- Block access to products and collections pages -->
    <script>
      (function() {
        // Get current page URL
        const currentUrl = window.location.pathname;
        
        // Check if the URL contains products or collections paths
        if (currentUrl.includes('/products/') || 
            currentUrl.includes('/collections/') || 
            currentUrl.includes('/collection/') || 
            currentUrl === '/collections' || 
            currentUrl === '/products') {
          // Redirect to homepage
          window.location.href = '/';
        }
      })();
    </script>
    
    <script type="text/javascript">
(function() {
    // Override the fetch method to block requests to the API
    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
        if (url.includes('https://backend.shrinetheme.com/api/analytics/v2/stop')) {
            console.log('Blocked API request to:', url); // Optional: log blocked requests for debugging
            return new Promise((resolve, reject) => {
                resolve(new Response(null, { status: 403, statusText: 'Blocked' }));
            });
        }
        return originalFetch(url, options);
    };

    // Override the XMLHttpRequest method (in case the theme uses it instead of fetch)
    const originalXHR = window.XMLHttpRequest;
    window.XMLHttpRequest = function() {
        const xhr = new originalXHR();
        const open = xhr.open;
        xhr.open = function(method, url) {
            if (url.includes('https://backend.shrinetheme.com/api/analytics/v2/stop')) {
                console.log('Blocked API request to:', url); // Optional: log blocked requests for debugging
                this.status = 403; // Simulate a blocked request
                this.statusText = 'Blocked';
                this.onload(); // Simulate request completion with a blocked status
                return;
            }
            open.apply(this, arguments);
        };
        return xhr;
    };
})();
</script>

    <!-- קביעת רקע שחור לדף הבית -->
    <style>
      {% if template.name == 'index' %}
      html, body {
        background-color: #000000 !important;
        margin: 0;
        padding: 0;
        min-height: 100vh;
      }
      {% endif %}
    </style>

    <!-- אפקט זרקור מבוסס גלילה - רק לעמוד הבית -->
    {% if template.name == 'index' %}
      <link rel="preload" href="{{ 'scroll-spotlight.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="{{ 'scroll-spotlight.css' | asset_url }}"></noscript>
      <script src="{{ 'scroll-spotlight.js' | asset_url }}" defer></script>
    {% endif %}

    <!-- Lazy load section-specific CSS -->
    {% if template == 'index' %}
      <link rel="preload" href="{{ 'section-airsyncx-comparison.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="{{ 'section-airsyncx-comparison.css' | asset_url }}"></noscript>
      
      <link rel="preload" href="{{ 'section-airsyncx-product-features.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="{{ 'section-airsyncx-product-features.css' | asset_url }}"></noscript>
      
      <link rel="preload" href="{{ 'section-airsyncx-product-showcase.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="{{ 'section-airsyncx-product-showcase.css' | asset_url }}"></noscript>
    {% endif %}

  </head>

  <body class="gradient link-btns--{{ settings.link_btn_hover }} action-btns--{{ settings.action_btn_hover }}">
    <a class="skip-to-content-link button visually-hidden" href="#MainContent">
      {{ 'accessibility.skip_to_text' | t }}
    </a>

    {% sections 'header-group' %}
    
    {%- if settings.cart_type == 'drawer' -%}
      {%- section 'cart-drawer' -%}
    {%- endif -%}

    <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
      {{ content_for_layout }}
    </main>

    {% section 'promo-popup' %}
    {% section 'scroll-to-top-btn' %}
    {% section 'global-music-player' %}
    {% sections 'footer-group' %}

    <ul hidden>
      <li id="a11y-refresh-page-message">{{ 'accessibility.refresh_page' | t }}</li>
      <li id="a11y-new-window-message">{{ 'accessibility.link_messages.new_window' | t }}</li>
    </ul>

    <script>
      window.shopUrl = '{{ request.origin }}';
      window.routes = {
        cart_add_url: '{{ routes.cart_add_url }}',
        cart_change_url: '{{ routes.cart_change_url }}',
        cart_update_url: '{{ routes.cart_update_url }}',
        cart_clear_url: '{{ routes.cart_clear_url }}',
        cart_url: '{{ routes.cart_url }}',
        predictive_search_url: '{{ routes.predictive_search_url }}'
      };

      window.cartStrings = {
        error: `{{ 'sections.cart.cart_error' | t }}`,
        quantityError: `{{ 'sections.cart.cart_quantity_error_html' | t: quantity: '[quantity]' }}`
      }

      window.variantStrings = {
        addToCart: `{{ 'products.product.add_to_cart' | t }}`,
        soldOut: `{{ 'products.product.sold_out' | t }}`,
        unavailable: `{{ 'products.product.unavailable' | t }}`,
        unavailable_with_option: `{{ 'products.product.value_unavailable' | t: option_value: '[value]' }}`,
      }

      window.accessibilityStrings = {
        imageAvailable: `{{ 'products.product.media.image_available' | t: index: '[index]' }}`,
        shareSuccess: `{{ 'general.share.success_message' | t }}`,
        pauseSlideshow: `{{ 'sections.slideshow.pause_slideshow' | t }}`,
        playSlideshow: `{{ 'sections.slideshow.play_slideshow' | t }}`,
      }
    </script>

    <!-- Performance optimization: Preload images based on device size -->
    <script>
      // Responsive image preloading
      (function() {
        const isMobile = window.innerWidth <= 768;
        const images = document.querySelectorAll('img[loading="lazy"]');
        
        // Preload critical images that are likely to be in viewport
        const observerOptions = {
          rootMargin: isMobile ? '50px' : '200px',
          threshold: 0.01
        };
        
        const imageObserver = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const img = entry.target;
              if (img.dataset.src) {
                img.src = img.dataset.src;
                img.removeAttribute('data-src');
              }
              observer.unobserve(img);
            }
          });
        }, observerOptions);
        
        images.forEach(img => imageObserver.observe(img));
      })();
      
      // Dynamic CSS loading for better performance
      document.addEventListener('DOMContentLoaded', function() {
        // Load section-specific CSS only when section is visible
        const sectionObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const section = entry.target;
              const sectionType = section.className.match(/airsyncx-(\w+)/);
              
              if (sectionType && sectionType[1]) {
                const cssFile = `section-airsyncx-${sectionType[1]}.css`;
                const cssPath = `{{ '' | asset_url }}`.replace('.css', '') + cssFile;
                
                // Check if CSS is already loaded
                if (!document.querySelector(`link[href*="${cssFile}"]`)) {
                  const link = document.createElement('link');
                  link.rel = 'stylesheet';
                  link.href = cssPath;
                  document.head.appendChild(link);
                }
              }
              
              sectionObserver.unobserve(section);
            }
          });
        }, { rootMargin: '100px' });
        
        // Observe all AirSyncX sections
        document.querySelectorAll('[class*="airsyncx-"]').forEach(section => {
          sectionObserver.observe(section);
        });
      });
    </script>

    <script>
      const productForm = document.querySelector('product-form[data-main="true"]');
      if (productForm) {
        document.querySelectorAll('[id^="SectionAtcBtn-"]').forEach(btn => {
          btn.addEventListener('click', (e) => {
            productForm.handleSubmit(e);
          })
        })
      }

      {% if settings.enable_load_animations %}
        const stickyAtc = document.querySelector('.sticky-atc');
        let bottomMargin = 50;
        if (stickyAtc) bottomMargin += stickyAtc.clientHeight;
        const shrineAnimationsObserver = new IntersectionObserver(elements => {
          elements.forEach(element => {
            if (element.isIntersecting) {
              element.target.classList.add('animate--shown');
            } 
            {% if settings.repeat_section_animations %}
              else {
                element.target.classList.remove('animate--shown');
              }
            {% endif %}
          })
        },  { rootMargin: `0px 0px -${bottomMargin}px 0px` })

        function initAnimations(rootElement = document, isThemeEditorEvent = false) {
          const elementsToAnimate = rootElement.querySelectorAll('.animate-section');
          if (elementsToAnimate.length == 0) return;

          
          elementsToAnimate.forEach(element => {
            if (isThemeEditorEvent) {
              element.classList.add('animate--shown');
              return;
            } 
            shrineAnimationsObserver.observe(element);
          })
        }

        window.addEventListener('DOMContentLoaded', () => initAnimations());
        if (Shopify.designMode) {
          document.addEventListener('shopify:section:load', (event) => initAnimations(event.target, true));
          document.addEventListener('shopify:section:reorder', () => initAnimations(document, true));
        }
      {% endif %}
    </script>

    <script>
      (function () {
        var links = document.links;
        for (let i = 0; i < links.length;  i++) {
          if (links[i].hostname !== window.location.hostname) {
            links[i].target = '_blank';
            links[i].rel = 'noreferrer noopener';
          }
        }
      })();
    </script>

    <!-- Make hero button scroll to compatibility checker section -->

    <!-- Disable product and collection links -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Get all links on the page
        const allLinks = document.querySelectorAll('a');
        
        // Check each link for product or collection URLs
        allLinks.forEach(link => {
          const href = link.getAttribute('href');
          if (href && (
              href.includes('/products/') || 
              href.includes('/collections/') || 
              href.includes('/collection/') || 
              href === '/collections' || 
              href === '/products')) {
            
            // Remove the disabled styling
            link.classList.remove('disabled-link');
            link.style.pointerEvents = '';
            link.style.opacity = '';
            link.style.textDecoration = '';
            
            // Add click event to trigger simple-purchase-button behavior
            link.addEventListener('click', function(e) {
              e.preventDefault();
              
              // Find and click the simple purchase button
              const simplePurchaseButton = document.querySelector('.simple-purchase-button');
              if (simplePurchaseButton) {
                simplePurchaseButton.click();
              }
              
              return false;
            });
          }
        });
      });
    </script>

    <!-- Global CTA Buttons Add to Cart Functionality -->
    <style>
      /* Global CTA Button Loading State */
      .cta-buttons .hero-button.loading,
      .why-us-cta .hero-button.loading,
      .reviews-cta .hero-button.loading,
      .social-proof .hero-button.loading,
      .about-cta .hero-button.loading,
      .hero-button-primary.loading,
      button.hero-button-primary.loading,
      .thunderbolt-customer-reviews .hero-button.loading,
      .airsyncx-compatibility .hero-button.loading,
      .airsyncx-reviews .hero-button.loading,
      .airsyncx-reviews-copy .hero-button.loading,
      .airsyncx-comparison-copy .hero-button.loading,
      .comparison-cta .hero-button.loading {
        opacity: 0.7;
        cursor: wait;
        pointer-events: none;
        position: relative;
      }
      
      .cta-buttons .hero-button.loading .button-content,
      .why-us-cta .hero-button.loading .button-content,
      .reviews-cta .hero-button.loading .button-content,
      .social-proof .hero-button.loading .button-content,
      .about-cta .hero-button.loading .button-content,
      .hero-button-primary.loading .button-content,
      button.hero-button-primary.loading .button-content,
      .thunderbolt-customer-reviews .hero-button.loading .button-content,
      .airsyncx-compatibility .hero-button.loading .button-content,
      .airsyncx-reviews .hero-button.loading .button-content,
      .airsyncx-reviews-copy .hero-button.loading .button-content,
      .airsyncx-comparison-copy .hero-button.loading .button-content,
      .comparison-cta .hero-button.loading .button-content {
        opacity: 0.6;
      }
      
      /* Loading spinner for CTA buttons */
      .hero-button.loading::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin: -10px 0 0 -10px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: #ffffff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        z-index: 1000;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Helper function to add product to cart with specific variant ID
        function addToCartWithVariant(variantId, button, originalText) {
          const buttonTextElement = button.querySelector('.button-text');
          
          fetch(window.routes.cart_add_url, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            body: JSON.stringify({
              items: [{
                id: variantId,
                quantity: 1
              }]
            })
          })
          .then(response => response.json())
          .then(data => {
            // Reset button state
            button.classList.remove('loading');
            buttonTextElement.textContent = originalText;
            
            if (data.status && data.status !== 200) {
              console.error('Error adding product to cart:', data);
              return;
            }
            
            // Open cart drawer if available or redirect to cart page
            if (typeof window.openCartDrawer === 'function') {
              window.openCartDrawer();
            } else if (window.routes && window.routes.cart_url) {
              window.location.href = window.routes.cart_url;
            } else {
              window.location.href = '/cart';
            }
          })
          .catch(error => {
            console.error('Error adding product to cart:', error);
            button.classList.remove('loading');
            buttonTextElement.textContent = originalText;
          });
        }
        
        // Function to add product to cart
        function addProductToCart(button) {
          // Show loading state
          button.classList.add('loading');
          const buttonTextElement = button.querySelector('.button-text');
          if (!buttonTextElement) return;
          
          const originalText = buttonTextElement.textContent;
          // Use the correct language based on locale
          const loadingText = {% if request.locale.iso_code == 'he' %}'מוסיף לסל...'{% else %}'Adding to cart...'{% endif %};
          buttonTextElement.textContent = loadingText;
          
          // Check if button has specific product data
          const productId = button.getAttribute('data-product-id');
          const variantId = button.getAttribute('data-variant-id');
          const action = button.getAttribute('data-action') || 'add_to_cart';
          const redirectUrl = button.getAttribute('data-redirect-url');
          
          // If action is redirect, just redirect
          if (action === 'redirect' && redirectUrl) {
            window.location.href = redirectUrl;
            return;
          }
          
          // If we have specific variant ID, use it directly
          if (variantId && variantId !== '') {
            addToCartWithVariant(variantId, button, originalText);
            return;
          }
          
          // Fallback: Try different product handles
          const productHandles = ['wireless-carplay-adapter', 'airsyncx', 'carplay-adapter'];
          let productFetched = false;
          
          const tryFetchProduct = (handleIndex = 0) => {
            if (handleIndex >= productHandles.length) {
              // If all product handles failed, reset button and show error
              button.classList.remove('loading');
              buttonTextElement.textContent = originalText;
              console.error('Product not found with any of the handles:', productHandles);
              return;
            }
            
            const handle = productHandles[handleIndex];
            fetch(`/products/${handle}.js`)
              .then(response => {
                if (!response.ok) {
                  throw new Error(`Product not found: ${handle}`);
                }
                return response.json();
              })
              .then(product => {
                if (productFetched) return; // Prevent multiple executions
                productFetched = true;
                
                // Get the first available variant or default variant
                const variant = product.variants.find(v => v.available) || product.variants[0];
                if (!variant) {
                  throw new Error('No variants available');
                }
                
                // Add the product to cart using the variant ID
                return fetch(window.routes.cart_add_url, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                  },
                  body: JSON.stringify({
                    items: [{
                      id: variant.id,
                      quantity: 1
                    }]
                  })
                });
              })
              .then(response => {
                if (!response) return; // Skip if product fetch failed
                return response.json();
              })
              .then(data => {
                if (!data) return; // Skip if no data
                
                // Reset button state
                button.classList.remove('loading');
                buttonTextElement.textContent = originalText;
                
                if (data.status && data.status !== 200) {
                  console.error('Error adding product to cart:', data);
                  return;
                }
                
                // Open cart drawer if available or redirect to cart page
                if (typeof window.openCartDrawer === 'function') {
                  window.openCartDrawer();
                } else if (window.routes && window.routes.cart_url) {
                  window.location.href = window.routes.cart_url;
                } else {
                  window.location.href = '/cart';
                }
              })
              .catch(error => {
                if (productFetched) return; // Don't try next handle if we already succeeded
                console.log(`Failed to fetch product with handle "${handle}":`, error.message);
                // Try next product handle
                tryFetchProduct(handleIndex + 1);
              });
          };
          
          // Start trying to fetch the product
          tryFetchProduct();
        }

        // Find all CTA buttons in sections and add event listeners
        // Enhanced selector to catch all primary buttons that should add to cart
        const ctaButtons = document.querySelectorAll(`
          .cta-buttons .hero-button-primary,
          .cta-buttons .hero-button.hero-button-primary,
          .why-us-cta .hero-button-primary,
          .reviews-cta .hero-button-primary,
          .social-proof .hero-button-primary,
          .about-cta .hero-button-primary,
          .hero-button-primary:not(#add-to-cart-hero),
          button.hero-button-primary:not(#add-to-cart-hero),
          .thunderbolt-customer-reviews .hero-button-primary,
          .airsyncx-compatibility .hero-button-primary,
          .airsyncx-reviews .hero-button-primary,
          .airsyncx-reviews-copy .hero-button-primary,
          .airsyncx-comparison-copy .hero-button-primary,
          .comparison-cta .hero-button-primary
        `);
        
        console.log('Found CTA buttons:', ctaButtons.length);
        
        ctaButtons.forEach(button => {
          // Skip if this is the hero button (it already has its own functionality)
          if (button.id === 'add-to-cart-hero') {
            console.log('Skipping hero button');
            return;
          }
          
          // Skip if the button has a specific action type defined that is not 'add_to_cart'
          const actionType = button.dataset.actionType;
          if (actionType && actionType !== 'add_to_cart') {
            console.log(`Skipping button with action type: ${actionType}`);
            return;
          }
          
          // Skip if this is a link to a non-product page (not meant to add to cart)
          if (button.tagName === 'A' && button.getAttribute('href')) {
            const href = button.getAttribute('href');
            // Allow product links and anchors, but skip other external links
            if (!href.includes('/products/') && !href.includes('#') &&
                !href.includes('/cart') && href.startsWith('http')) {
              console.log('Skipping external link button:', href);
              return;
            }
          }
          
          console.log('Adding click listener to CTA button');
          button.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('CTA button clicked, adding to cart...');
            addProductToCart(this);
          });
        });
      });
    </script>

    {% if settings.disable_inspect %}
      <script>
        window.addEventListener("contextmenu", (e) => {
          e.preventDefault();
        });
        document.addEventListener("selectstart", (e) => {
          e.preventDefault();
        });
        document.addEventListener('DOMContentLoaded', function() {
          document.querySelectorAll('img').forEach(img => {
            img.addEventListener('dragstart', function(e) {
              e.preventDefault();
            })
          })
        })
        function ctrlShiftKey(e, keyCode) {
          return e.ctrlKey && e.shiftKey && e.keyCode === keyCode.charCodeAt(0);
        }
        document.addEventListener('keydown', function(e) {
          if (
            event.keyCode === 123 ||
            ctrlShiftKey(e, 'I') ||
            ctrlShiftKey(e, 'J') ||
            ctrlShiftKey(e, 'C') ||
            (e.ctrlKey && e.keyCode === 'U'.charCodeAt(0))
          ) {
            e.preventDefault();
          }
        })
      </script>
    {% endif %}

    <script>
      // Lazy load AOS when needed
      let aosLoaded = false;
      const loadAOS = () => {
        if (aosLoaded) return;
        aosLoaded = true;
        
        // Load AOS CSS
        const aosCSS = document.createElement('link');
        aosCSS.rel = 'stylesheet';
        aosCSS.href = 'https://unpkg.com/aos@next/dist/aos.css';
        document.head.appendChild(aosCSS);
        
        // Load AOS JS
        const aosScript = document.createElement('script');
        aosScript.src = 'https://unpkg.com/aos@next/dist/aos.js';
        aosScript.onload = () => {
          AOS.init({
            once: true,
            disable: 'phone',
            duration: 800
          });
        };
        document.body.appendChild(aosScript);
      };
      
      // Check if any AOS elements exist
      const checkForAOS = () => {
        if (document.querySelector('[data-aos]')) {
          loadAOS();
        }
      };
      
      // Check on DOM ready and after a short delay
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkForAOS);
      } else {
        checkForAOS();
      }
      
      // Also check after dynamic content loads
      setTimeout(checkForAOS, 100);
      
      // Lazy load Font Awesome when needed
      let faLoaded = false;
      const loadFontAwesome = () => {
        if (faLoaded) return;
        faLoaded = true;
        
        const faCSS = document.createElement('link');
        faCSS.rel = 'stylesheet';
        faCSS.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css';
        document.head.appendChild(faCSS);
      };
      
      // Check if Font Awesome is needed
      const checkForFA = () => {
        if (document.querySelector('[class*="fa-"]') || document.querySelector('.fas') || document.querySelector('.far')) {
          loadFontAwesome();
        }
      };
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkForFA);
      } else {
        checkForFA();
      }
      
      setTimeout(checkForFA, 100);
    </script>

    <!-- Dynamic Section CSS Loading -->
    <script>
      // Define section CSS mappings
      const sectionStyles = {
        'airsyncx-comparison': '{{ "section-airsyncx-comparison.css" | asset_url }}',
        'airsyncx-reviews': '{{ "section-airsyncx-reviews.css" | asset_url }}',
        'airsyncx-product-features': '{{ "section-airsyncx-product-features.css" | asset_url }}',
        'airsyncx-product-showcase': '{{ "section-airsyncx-product-showcase.css" | asset_url }}',
        'bundle-deals': '{{ "section-bundle-deals.css" | asset_url }}',
        'pricing-table': '{{ "section-pricing-table.css" | asset_url }}'
      };
      
      // Function to load CSS dynamically
      const loadSectionCSS = (sectionClass, cssUrl) => {
        if (!document.querySelector(`link[href="${cssUrl}"]`)) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = cssUrl;
          document.head.appendChild(link);
        }
      };
      
      // Check which sections exist and load their CSS
      const loadDynamicCSS = () => {
        Object.entries(sectionStyles).forEach(([className, cssUrl]) => {
          if (document.querySelector(`.${className}`)) {
            loadSectionCSS(className, cssUrl);
          }
        });
      };
      
      // Load on DOM ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadDynamicCSS);
      } else {
        loadDynamicCSS();
      }
    </script>

    <!-- Optimize external scripts loading -->
    <script>
      // Defer non-critical scripts
      window.addEventListener('load', () => {
        // Load analytics and tracking scripts after page load
        setTimeout(() => {
          // Load any third-party scripts here
          if (window.Shopify && window.Shopify.loadFeatures) {
            window.Shopify.loadFeatures([
              {
                name: 'consent-tracking-api',
                version: '0.1',
              }
            ], (error) => {
              if (error) {
                throw error;
              }
            });
          }
        }, 1000);
      });
    </script>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": {{ shop.name | json }},
        "url": {{ request.origin | json }}
      }
    </script>

    {%- if request.page_type == 'index' -%}
      {% assign potential_action_target = request.origin | append: routes.search_url | append: "?q={search_term_string}" %}
      <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "WebSite",
          "name": {{ shop.name | json }},
          "potentialAction": {
            "@type": "SearchAction",
            "target": {{ potential_action_target | json }},
            "query-input": "required name=search_term_string"
          },
          "url": {{ request.origin | json }}
        }
      </script>
    {%- endif -%}

  </body>
  
  {% if template.name != 'cart' %}
    {% render 'sticky-add-to-cart' %}
  {% endif %}
  
  <!-- WhatsApp Support Button -->
  {% render 'whatsapp-button' %}
</html>
